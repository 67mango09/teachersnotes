<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Homework Helper</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f0f4f8; }
  .container { max-width:700px; margin:auto; background:#ffffffcc; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
  h1 { text-align:center; }
  button { padding:10px 20px; border-radius:6px; border:none; background:#007bff; color:white; cursor:pointer; margin:10px 0; }
  button:hover { background:#0056b3; }
  #extractedText { margin-top:20px; padding:10px; background:#e8e8e8; border-radius:8px; min-height:40px; white-space: pre-wrap; }
  video, canvas { display:block; margin:10px auto; border-radius:8px; max-width:100%; }
</style>
</head>
<body>

<div class="container">
  <h1>Homework Helper</h1>

  <!-- Upload Image -->
  <input type="file" id="questionImage" accept="image/*"><br>
  <button id="solveBtn">Extract Text from Uploaded Photo</button>

  <hr>

  <!-- Webcam Capture -->
  <video id="video" autoplay playsinline width="400" height="300"></video><br>
  <button id="captureBtn">Capture Photo</button>
  <canvas id="canvas" width="400" height="300" style="display:none;"></canvas>
  <button id="solvePhotoBtn">Extract Text from Captured Photo</button>

  <div id="extractedText">Question will appear here...</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@v4.0.2/dist/tesseract.min.js"></script>
<script>
// Elements
const imageInput = document.getElementById('questionImage');
const solveBtn = document.getElementById('solveBtn');
const extractedTextDiv = document.getElementById('extractedText');

const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const captureBtn = document.getElementById('captureBtn');
const solvePhotoBtn = document.getElementById('solvePhotoBtn');
const ctx = canvas.getContext('2d');

// ------------------- Webcam -------------------
navigator.mediaDevices.getUserMedia({ video:true })
  .then(stream => { video.srcObject = stream; })
  .catch(err => console.error("Webcam error:", err));

captureBtn.addEventListener('click', () => {
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  alert("Photo captured! Click 'Extract Text from Captured Photo'");
});

// ------------------- OCR -------------------
async function runOCR(fileOrCanvas){
  extractedTextDiv.textContent = "Extracting text...";
  try{
    const { data: { text } } = await Tesseract.recognize(fileOrCanvas, 'eng', { logger:m=>console.log(m) });
    extractedTextDiv.textContent = "Question extracted:\n" + text.trim();
  } catch(err){
    console.error(err);
    extractedTextDiv.textContent = "Error extracting text.";
  }
}

// ------------------- Solve Uploaded -------------------
solveBtn.addEventListener('click', () => {
  const file = imageInput.files[0];
  if(!file) return alert("Upload a question image!");
  runOCR(file);
});

// ------------------- Solve Captured -------------------
solvePhotoBtn.addEventListener('click', () => {
  runOCR(canvas);
});
</script>

</body>
</html>
